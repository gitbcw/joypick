# 客服接入与企业微信方案说明

## 背景与现状
- 当前“咨询客服”主要依赖微信小程序官方客服入口与被动消息的转接客服能力；不自建即时通讯与聊天记录存储。
- 用户问题收集以“意见反馈”和“售后”两类表单为主，由管理后台进行查看、审核与退款闭环。
- 聊天类会话与坐席分配托管在微信/企业微信体系内，项目仅保留必要的业务记录与通知，不采集聊天正文。

## 目标与原则
- 目标：将“咨询客服”统一接入企业微信，点击可跳转至企业微信侧的客服会话；未绑定的用户展示企业微信“活码”二维码引导添加。
- 原则：
  - 合规与隐私优先，不落地聊天内容，仅记录绑定与关键事件。
  - 入口统一、配置集中、可灰度发布与快速更换活码。
  - 前端体验清晰，失败有兜底（扫码/保存二维码/外链跳转）。

## 方案方向（不涉及代码）
- 入口统一：在商品页与个人中心统一“咨询客服”入口，指向企业微信客服。
- 跳转方式：
  - 已添加企业微信客服的用户，直接跳转至企业微信会话或客服页面。
  - 未添加的用户，弹出企业微信“活码”二维码，提示扫码添加后再发起咨询。
- 活码管理：
  - 使用企业微信“活码”，由运营维护；可动态替换二维码而无需改动代码。
  - 活码地址/图片由配置中心维护，便于多环境区分与应急更新。

## 用户体验流程（示意）
- 用户点击“咨询客服”→ 检查是否已添加企业微信客服：
  - 已添加 → 直接跳转至企业微信会话（或客服H5页面）。
  - 未添加 → 弹窗展示活码二维码，用户扫码添加；添加完成后再次点击即可跳转。
- 兜底选项：提供“保存二维码到相册”“打开企业微信”按钮，降低扫码失败的影响。

## 配置与数据
- 配置项（集中管理）：
  - 企业微信客服会话跳转 URL（或页面标识）。
  - 企业微信活码二维码图片地址与更新描述。
  - 文案配置（引导语、失败提示、隐私说明）。
- 数据记录（最小必要）：
  - 用户与企业微信绑定状态（是否已添加客服）与最近一次咨询时间。
  - 运营统计与埋点事件：点击入口、展示二维码、完成添加、跳转成功/失败。

## 运维与监控
- 运营台维护活码与跳转地址，支持预览与一键生效。
- 监控关键转化漏斗：入口点击 → 二维码展示 → 添加完成 → 会话跳转；异常率预警。
- 日志与告警：活码加载失败、跳转失败、图片权限受限等场景及时提醒。

## 风险与合规
- 隐私合规：不采集聊天正文；必要的绑定状态与事件仅用于体验与统计。
- 平台限制：小程序内唤起企业微信存在平台限制与机型差异，需提供二维码兜底。
- 网络与权限：二维码展示依赖网络与相册权限，需明确授权提示与替代路径。

## 迭代路线
- 阶段1（快速上线）：统一入口，未添加展示活码二维码；已添加通过外链/指引跳转企业微信。
- 阶段2（体验优化）：完善绑定状态判断与免扫码跳转路径，丰富失败兜底与文案。
- 阶段3（通知回流）：在反馈/售后关键节点增加模板消息或企业微信消息提醒，提升服务闭环。

## 与现有实现的关系
- 保留现有反馈与售后流程用于结构化问题收集与售后处理；咨询类即时沟通迁移至企业微信。
- 运营可平滑切换：在活码与跳转配置稳定后，可逐步减少微信小程序原生客服入口的曝光。

## 开放问题与后续工作
- 绑定状态的判定口径与来源（与企业微信的用户标识打通方案）。
- 跳转能力的具体形态与跨端差异（iOS/Android/不同微信版本）。
- 管理后台的配置界面与灰度能力（多环境、多渠道活码管理）。

> 备注：如需更深入的联动细节与运营策略，可参考《企业微信与小程序联动.md》中关于“活码”的说明与实践建议。
